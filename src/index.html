<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Job Search Assistant - Enhanced</title>
    <meta name="description" content="Find real jobs with AI-powered resume tailoring and professional cover letters">
    
    <!-- SEO and Social Media Meta Tags -->
    <meta property="og:title" content="AI Job Search Assistant">
    <meta property="og:description" content="Find your dream job with AI-powered resume tailoring and cover letter generation">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AI Job Search Assistant">
    <meta name="twitter:description" content="Find your dream job with AI-powered tools">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ñ</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .beta-badge {
            background: #ff6b6b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .api-status {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            font-size: 0.9rem;
        }

        .api-status.online {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .api-status.offline {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: #667eea;
            outline: none;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .jobs-container {
            max-height: 600px;
            overflow-y: auto;
        }

        .job-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            position: relative;
        }

        .job-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .job-source {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-bottom: 10px;
        }

        .match-score {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .real-job-badge {
            background: #28a745;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 10px;
        }

        /* Resume Upload Styles */
        .resume-upload-area {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .resume-upload-area:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .resume-upload-area.dragover {
            border-color: #667eea;
            background: #e8f0fe;
            transform: scale(1.02);
        }

        .resume-uploaded {
            background: #d4edda;
            border-color: #28a745;
        }

        .resume-info {
            background: #e8f0fe;
            border: 1px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .resume-preview {
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .file-input {
            display: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }
        .notification.info { background: #17a2b8; }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .api-selector {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .api-selector label {
            color: white;
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
        }

        .api-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .api-option {
            background: white;
            border-radius: 6px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            flex: 1;
            min-width: 200px;
        }

        .api-option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .api-option:hover {
            background: rgba(102, 126, 234, 0.05);
            transform: translateY(-2px);
        }

        .feature-announcement {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .coming-soon {
            opacity: 0.7;
            position: relative;
        }

        .coming-soon::after {
            content: "üîú Coming Soon";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffc107;
            color: #000;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 15px;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #000;
        }

        .filters-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .salary-range {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 1s ease;
        }

        .job-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            color: white;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }

        .cover-letter-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .search-bar {
                flex-direction: column;
            }
            
            .api-options {
                flex-direction: column;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }

            .filter-row {
                flex-direction: column;
                align-items: stretch;
            }

            .match-score {
                position: static;
                display: inline-block;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ü§ñ AI Job Search Assistant<span class="beta-badge">ENHANCED</span></h1>
            <p>Find real jobs with AI-powered resume tailoring & cover letters</p>
        </header>

        <!-- Job Statistics -->
        <div class="job-stats">
            <div class="stat-card">
                <span class="stat-value" id="totalJobs">0</span>
                <span>Total Jobs</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="matchingJobs">0</span>
                <span>Matching</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="avgMatch">0%</span>
                <span>Avg Match</span>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="remoteJobs">0</span>
                <span>Remote</span>
            </div>
        </div>

        <div class="feature-announcement">
            <strong>üöÄ New Features!</strong> Resume upload, AI matching scores, cover letter generation, and enhanced filtering!
        </div>

        <div class="api-selector">
            <label>Choose Your Job Search Source:</label>
            <div class="api-options">
                <div class="api-option selected" data-source="demo">
                    <strong>üìã Demo Jobs</strong><br>
                    <small>Enhanced sample positions</small>
                </div>
                <div class="api-option coming-soon" data-source="indeed">
                    <strong>üîç Indeed API</strong><br>
                    <small>Real jobs from Indeed</small>
                </div>
                <div class="api-option coming-soon" data-source="github">
                    <strong>üíª GitHub Jobs</strong><br>
                    <small>Tech positions from GitHub</small>
                </div>
                <div class="api-option coming-soon" data-source="linkedin">
                    <strong>üíº LinkedIn API</strong><br>
                    <small>Professional network jobs</small>
                </div>
            </div>
        </div>

        <div id="apiStatus" class="api-status offline">
            üîß Currently using enhanced demo data - Real job APIs coming soon!
        </div>

        <!-- Resume Upload Section -->
        <div class="card">
            <h3>üìÑ Resume Upload</h3>
            <div id="resumeUploadArea" class="resume-upload-area" onclick="document.getElementById('resumeFile').click()">
                <div id="uploadPrompt">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üìÑ</div>
                    <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Upload Your Resume</div>
                    <div style="color: #6c757d; margin-bottom: 15px;">
                        Drag & drop your resume here or click to browse<br>
                        <small>Supports PDF, DOC, DOCX, TXT files (max 5MB)</small>
                    </div>
                    <button class="btn btn-primary" type="button">Choose File</button>
                </div>
                <div id="uploadedResume" style="display: none;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">‚úÖ</div>
                    <div style="font-size: 1.2rem; font-weight: 600; color: #28a745; margin-bottom: 10px;">Resume Uploaded Successfully!</div>
                    <div id="resumeFileName" style="color: #6c757d; margin-bottom: 15px;"></div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="viewResumePreview()">Preview</button>
                        <button class="btn btn-danger" onclick="removeResume()">Remove</button>
                    </div>
                </div>
            </div>
            <input type="file" id="resumeFile" class="file-input" accept=".pdf,.doc,.docx,.txt" onchange="handleFileUpload(this)">
            <div id="resumeInfo" class="resume-info" style="display: none;">
                <div><strong>File:</strong> <span id="fileName"></span></div>
                <div><strong>Size:</strong> <span id="fileSize"></span></div>
                <div><strong>Type:</strong> <span id="fileType"></span></div>
                <div><strong>Uploaded:</strong> <span id="uploadDate"></span></div>
            </div>
        </div>

        <div class="card">
            <h3>üîç Job Search</h3>
            <div class="search-bar">
                <input type="text" id="jobQuery" class="search-input" placeholder="Job title or keywords (e.g., React Developer)">
                <input type="text" id="locationQuery" class="search-input" placeholder="Location (e.g., Remote, San Francisco)">
                <select id="jobTypeFilter" class="search-input" style="flex: 0.5;">
                    <option value="">All Types</option>
                    <option value="full-time">Full Time</option>
                    <option value="part-time">Part Time</option>
                    <option value="remote">Remote</option>
                    <option value="contract">Contract</option>
                </select>
                <button class="btn btn-primary" onclick="searchJobs()">üîç Search Jobs</button>
            </div>
            
            <!-- Enhanced Filters -->
            <div class="filters-section">
                <h4 style="margin-bottom: 15px;">üéØ Advanced Filters</h4>
                <div class="filter-row">
                    <div class="salary-range">
                        <label>Salary Range:</label>
                        <input type="range" id="minSalary" min="30000" max="200000" step="10000" value="50000">
                        <span id="minSalaryLabel">$50k</span>
                        <span>to</span>
                        <input type="range" id="maxSalary" min="50000" max="300000" step="10000" value="150000">
                        <span id="maxSalaryLabel">$150k</span>
                    </div>
                    <div>
                        <label for="sortBy">Sort by:</label>
                        <select id="sortBy" class="search-input" style="width: auto; min-width: 150px;">
                            <option value="match">Best Match</option>
                            <option value="date">Most Recent</option>
                            <option value="salary">Highest Salary</option>
                            <option value="company">Company A-Z</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>üíº Job Listings</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="searchProgress" style="width: 0%"></div>
            </div>
            <div id="jobsContainer" class="jobs-container">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>üîÑ Loading enhanced job opportunities...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Resume Preview Modal -->
    <div id="resumeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeResumeModal()">&times;</span>
            <h2>üìÑ Resume Preview</h2>
            <div id="resumePreviewContent" class="resume-preview">
                Loading resume preview...
            </div>
        </div>
    </div>

    <!-- Tailored Resume Modal -->
    <div id="tailoredResumeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTailoredResumeModal()">&times;</span>
            <h2>üéØ Tailored Resume</h2>
            <div id="tailoredResumeContent" style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-top: 15px;">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>ü§ñ AI is tailoring your resume for this position...</p>
                </div>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-primary" onclick="downloadTailoredResume()" style="display: none;" id="downloadTailoredBtn">üì• Download Tailored Resume</button>
                <button class="btn btn-info" onclick="generateCoverLetter()" style="display: none;" id="generateCoverLetterBtn">üìù Generate Cover Letter</button>
            </div>
            
            <!-- Cover Letter Section -->
            <div id="coverLetterSection" class="cover-letter-section" style="display: none;">
                <h4>üìù AI-Generated Cover Letter</h4>
                <div id="coverLetterContent" style="background: white; padding: 15px; border-radius: 6px; margin-top: 10px;">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        <p>ü§ñ Generating personalized cover letter...</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button class="btn btn-success" onclick="downloadCoverLetter()" style="display: none;" id="downloadCoverLetterBtn">üì• Download Cover Letter</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('üöÄ AI Job Search Assistant - Enhanced Version');

        // Application state
        let currentSource = 'demo';
        let allJobs = [];
        let filteredJobs = [];
        let uploadedResume = null;
        let resumeText = '';
        let searchProgress = 0;

        // Configuration for different job APIs
        const JOB_APIS = {
            demo: {
                name: 'Enhanced Demo Jobs',
                enabled: true,
                fetch: () => Promise.resolve(getEnhancedDemoJobs())
            },
            indeed: {
                name: 'Indeed API',
                enabled: false,
                fetch: (query, location) => fetchIndeedJobs(query, location)
            },
            github: {
                name: 'GitHub Jobs',
                enabled: false,
                fetch: (query, location) => fetchGitHubJobs(query, location)
            },
            linkedin: {
                name: 'LinkedIn API', 
                enabled: false,
                fetch: (query, location) => fetchLinkedInJobs(query, location)
            }
        };

        // Enhanced demo jobs with better matching data
        function getEnhancedDemoJobs() {
            return [
                {
                    id: 'demo-1',
                    title: 'Senior Frontend Developer',
                    company: 'TechFlow Inc.',
                    location: 'San Francisco, CA',
                    type: 'full-time',
                    salary: '$120,000 - $160,000',
                    salaryMin: 120000,
                    salaryMax: 160000,
                    description: 'Join our dynamic team building next-generation web applications with React, TypeScript, and modern tools. Lead frontend architecture decisions and mentor junior developers in a collaborative environment.',
                    requirements: ['React', 'TypeScript', 'JavaScript', 'HTML/CSS', 'Git', 'Agile', 'Node.js'],
                    benefits: ['Health Insurance', 'Pension Plan', 'Stock Options', 'Training Programs'],
                    posted: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job4',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-5',
                    title: 'DevOps Engineer',
                    company: 'CloudTech Solutions',
                    location: 'Seattle, WA',
                    type: 'full-time',
                    salary: '$130,000 - $170,000',
                    salaryMin: 130000,
                    salaryMax: 170000,
                    description: 'Manage cloud infrastructure and deployment pipelines. Expertise in AWS, Docker, and automation tools required. Lead DevOps initiatives and mentor team members.',
                    requirements: ['AWS', 'Docker', 'Kubernetes', 'Terraform', 'Jenkins', 'Python', 'Linux'],
                    benefits: ['Stock Options', 'Remote Work', 'Health Insurance', 'Conference Budget'],
                    posted: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job5',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-6',
                    title: 'Frontend Developer',
                    company: 'Creative Studios',
                    location: 'Austin, TX', 
                    type: 'part-time',
                    salary: '$65,000 - $85,000',
                    salaryMin: 65000,
                    salaryMax: 85000,
                    description: 'Create stunning user interfaces for creative projects. Strong focus on design implementation and user experience. Work with designers and UX teams.',
                    requirements: ['HTML', 'CSS', 'JavaScript', 'Vue.js', 'Figma', 'Responsive Design', 'SASS'],
                    benefits: ['Flexible Schedule', 'Creative Freedom', 'Health Insurance', 'Design Tools'],
                    posted: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job6',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-7',
                    title: 'Python Developer',
                    company: 'DataTech Analytics',
                    location: 'Remote',
                    type: 'remote',
                    salary: '$90,000 - $130,000',
                    salaryMin: 90000,
                    salaryMax: 130000,
                    description: 'Develop data processing applications and APIs using Python. Work with machine learning models and big data technologies in a data-driven environment.',
                    requirements: ['Python', 'Django', 'PostgreSQL', 'Redis', 'Machine Learning', 'pandas', 'NumPy'],
                    benefits: ['Remote First', 'Learning Budget', 'Health Insurance', 'Flexible Hours'],
                    posted: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job7',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-8',
                    title: 'Mobile App Developer',
                    company: 'AppCraft Studios',
                    location: 'Los Angeles, CA',
                    type: 'full-time',
                    salary: '$110,000 - $150,000',
                    salaryMin: 110000,
                    salaryMax: 150000,
                    description: 'Build cross-platform mobile applications using React Native. Work on consumer-facing apps with millions of downloads and focus on performance optimization.',
                    requirements: ['React Native', 'JavaScript', 'iOS', 'Android', 'Redux', 'Firebase', 'Jest'],
                    benefits: ['Health Insurance', 'Stock Options', 'Gym Membership', 'Team Events'],
                    posted: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job8',
                    isReal: false,
                    matchScore: 0
                }
            ];
        }

        // Enhanced resume upload functionality
        function handleFileUpload(input) {
            const file = input.files[0];
            if (!file) return;

            // Validate file
            if (!validateFile(file)) return;

            uploadedResume = file;
            showResumeUploaded(file);
            processResume(file);
        }

        function validateFile(file) {
            const maxSize = 5 * 1024 * 1024; // 5MB
            const allowedTypes = [
                'application/pdf', 
                'application/msword', 
                'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 
                'text/plain'
            ];

            if (file.size > maxSize) {
                showNotification('File too large. Please upload a file smaller than 5MB.', 'error');
                return false;
            }

            if (!allowedTypes.includes(file.type)) {
                showNotification('Unsupported file type. Please upload PDF, DOC, DOCX, or TXT files.', 'error');
                return false;
            }

            return true;
        }

        function showResumeUploaded(file) {
            document.getElementById('uploadPrompt').style.display = 'none';
            document.getElementById('uploadedResume').style.display = 'block';
            document.getElementById('resumeUploadArea').classList.add('resume-uploaded');
            
            document.getElementById('resumeFileName').textContent = file.name;
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('fileType').textContent = file.type;
            document.getElementById('uploadDate').textContent = new Date().toLocaleString();
            document.getElementById('resumeInfo').style.display = 'block';

            showNotification('Resume uploaded successfully! AI matching enabled üéâ', 'success');
            
            // Recalculate match scores if jobs are already loaded
            if (allJobs.length > 0) {
                calculateMatchScores();
                renderJobs(filteredJobs);
                updateJobStats();
            }
        }

        async function processResume(file) {
            try {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Enhanced resume processing
                    if (file.type === 'text/plain') {
                        resumeText = e.target.result;
                    } else {
                        // Simulate extracted resume content with more realistic data
                        resumeText = `John Doe
Software Developer
Email: john.doe@email.com | Phone: (555) 123-4567

EXPERIENCE
Senior Frontend Developer | TechCorp | 2021-2024
- Developed responsive web applications using React, TypeScript, and JavaScript
- Implemented modern UI/UX designs with HTML5, CSS3, and SASS
- Collaborated with backend teams using REST APIs and GraphQL
- Managed code versioning with Git and participated in Agile development cycles
- Mentored junior developers and conducted code reviews

Full Stack Developer | StartupABC | 2019-2021
- Built end-to-end web applications using Node.js, Express, and MongoDB
- Developed frontend interfaces with React and Redux for state management
- Deployed applications on AWS using Docker containers and EC2 instances
- Implemented automated testing with Jest and continuous integration pipelines

EDUCATION
Bachelor of Science in Computer Science
University of Technology | 2015-2019

SKILLS
Frontend: React, JavaScript, TypeScript, HTML5, CSS3, SASS, Vue.js
Backend: Node.js, Python, Java, Express, Django, Spring Boot
Databases: MongoDB, PostgreSQL, MySQL, Redis
Cloud & DevOps: AWS, Docker, Kubernetes, Jenkins, Git
Other: REST APIs, GraphQL, Microservices, Agile, Testing (Jest, Cypress)`;
                    }
                    
                    // Calculate match scores for existing jobs
                    if (allJobs.length > 0) {
                        calculateMatchScores();
                        renderJobs(filteredJobs);
                        updateJobStats();
                    }
                };
                reader.readAsText(file);
            } catch (error) {
                console.error('Error processing resume:', error);
                showNotification('Error processing resume. Please try again.', 'error');
            }
        }

        // Enhanced match score calculation
        function calculateMatchScores() {
            if (!resumeText) {
                allJobs.forEach(job => job.matchScore = 0);
                return;
            }

            const resumeLower = resumeText.toLowerCase();
            const resumeSkills = extractSkillsFromText(resumeLower);

            allJobs.forEach(job => {
                let score = 0;
                let totalRequirements = job.requirements ? job.requirements.length : 1;

                if (job.requirements) {
                    job.requirements.forEach(requirement => {
                        const reqLower = requirement.toLowerCase();
                        
                        // Check for exact skill matches
                        if (resumeSkills.includes(reqLower) || resumeLower.includes(reqLower)) {
                            score += 100 / totalRequirements;
                        }
                        
                        // Check for partial matches
                        else if (findPartialMatch(reqLower, resumeSkills)) {
                            score += 50 / totalRequirements;
                        }
                    });
                }

                // Bonus points for experience level
                if (resumeLower.includes('senior') && job.title.toLowerCase().includes('senior')) {
                    score += 10;
                }
                
                // Location preference
                if (job.type === 'remote' && resumeLower.includes('remote')) {
                    score += 5;
                }

                job.matchScore = Math.min(Math.round(score), 100);
            });
        }

        function extractSkillsFromText(text) {
            const commonSkills = [
                'javascript', 'react', 'node.js', 'python', 'java', 'typescript',
                'html', 'css', 'sql', 'mongodb', 'postgresql', 'aws', 'docker',
                'kubernetes', 'git', 'redux', 'vue.js', 'angular', 'express',
                'django', 'spring', 'graphql', 'rest', 'microservices', 'agile',
                'testing', 'jest', 'cypress', 'sass', 'webpack', 'jenkins',
                'terraform', 'redis', 'linux', 'firebase', 'next.js', 'figma'
            ];

            return commonSkills.filter(skill => text.includes(skill.toLowerCase()));
        }

        function findPartialMatch(requirement, skills) {
            // Look for related skills
            const relatedSkills = {
                'javascript': ['js', 'typescript', 'node.js', 'react'],
                'react': ['javascript', 'jsx', 'redux', 'next.js'],
                'python': ['django', 'flask', 'pandas', 'numpy'],
                'java': ['spring', 'hibernate', 'maven'],
                'aws': ['cloud', 'ec2', 's3', 'lambda'],
                'docker': ['containers', 'kubernetes', 'devops']
            };

            if (relatedSkills[requirement]) {
                return relatedSkills[requirement].some(related => 
                    skills.includes(related) || skills.some(skill => skill.includes(related))
                );
            }

            return false;
        }

        function removeResume() {
            uploadedResume = null;
            resumeText = '';
            document.getElementById('uploadPrompt').style.display = 'block';
            document.getElementById('uploadedResume').style.display = 'none';
            document.getElementById('resumeUploadArea').classList.remove('resume-uploaded');
            document.getElementById('resumeInfo').style.display = 'none';
            document.getElementById('resumeFile').value = '';
            
            // Reset match scores
            allJobs.forEach(job => job.matchScore = 0);
            renderJobs(filteredJobs);
            updateJobStats();
            
            showNotification('Resume removed successfully.', 'info');
        }

        function viewResumePreview() {
            if (!resumeText) {
                showNotification('Resume preview not available. Please re-upload your resume.', 'error');
                return;
            }

            document.getElementById('resumePreviewContent').innerHTML = 
                `<pre style="white-space: pre-wrap; font-family: inherit;">${resumeText}</pre>`;
            document.getElementById('resumeModal').style.display = 'block';
        }

        function closeResumeModal() {
            document.getElementById('resumeModal').style.display = 'none';
        }

        // Enhanced tailoring functionality
        function tailorResumeForJob(jobId) {
            if (!uploadedResume) {
                showNotification('Please upload your resume first to use the tailoring feature.', 'error');
                return;
            }

            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;

            document.getElementById('tailoredResumeModal').style.display = 'block';
            document.getElementById('tailoredResumeContent').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>ü§ñ AI is tailoring your resume for this position...</p>
                </div>
            `;
            
            // Simulate AI processing with progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    
                    setTimeout(() => {
                        const tailoredContent = generateTailoredResume(job);
                        document.getElementById('tailoredResumeContent').innerHTML = tailoredContent;
                        document.getElementById('downloadTailoredBtn').style.display = 'inline-block';
                        document.getElementById('generateCoverLetterBtn').style.display = 'inline-block';
                    }, 500);
                }
            }, 200);
        }

        function generateTailoredResume(job) {
            const matchedSkills = job.requirements ? 
                job.requirements.filter(req => resumeText.toLowerCase().includes(req.toLowerCase())) : [];
            
            return `
                <div style="background: white; padding: 20px; border-radius: 8px; font-family: 'Times New Roman', serif;">
                    <h3 style="color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px;">
                        Resume Tailored for: ${job.title}
                    </h3>
                    <p style="color: #666; font-style: italic; margin-bottom: 20px;">
                        Optimized for ${job.company} ‚Ä¢ Match Score: <strong style="color: #28a745;">${job.matchScore}%</strong>
                    </p>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">üéØ Key Matches Highlighted:</h4>
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 6px; border-left: 4px solid #28a745;">
                            ${matchedSkills.length > 0 ? 
                                `<strong>‚úÖ Matched Skills (${matchedSkills.length}/${job.requirements.length}):</strong><br>
                                 ${matchedSkills.map(skill => `<span style="background: #28a745; color: white; padding: 2px 6px; border-radius: 3px; margin: 2px; font-size: 0.8rem;">${skill}</span>`).join(' ')}` :
                                'Skills emphasized based on job requirements'
                            }
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">üìù Tailored Professional Summary:</h4>
                        <p style="background: #f8f9fa; padding: 15px; border-left: 4px solid #667eea; margin: 0; line-height: 1.6;">
                            Experienced ${job.title.toLowerCase()} with proven expertise in 
                            ${matchedSkills.slice(0, 3).join(', ') || 'relevant technologies'} 
                            seeking to contribute to ${job.company}'s innovative team. 
                            ${job.type === 'remote' ? 'Experienced in remote collaboration with distributed teams. ' : ''}
                            Demonstrated track record in delivering scalable solutions and driving technical excellence 
                            in ${job.type === 'full-time' ? 'enterprise' : 'agile'} environments.
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">üîÑ Optimization Summary:</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                            <div style="background: #fff3cd; padding: 10px; border-radius: 6px; border: 1px solid #ffeaa7;">
                                <strong>üìä Match Score:</strong><br>
                                <span style="font-size: 1.5rem; color: #28a745;">${job.matchScore}%</span>
                            </div>
                            <div style="background: #d1ecf1; padding: 10px; border-radius: 6px; border: 1px solid #bee5eb;">
                                <strong>üí∞ Salary Range:</strong><br>
                                <span>${job.salary}</span>
                            </div>
                            <div style="background: #d4edda; padding: 10px; border-radius: 6px; border: 1px solid #c3e6cb;">
                                <strong>üìç Location:</strong><br>
                                <span>${job.location}</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">üöÄ Tailoring Actions Taken:</h4>
                        <ul style="color: #666; font-size: 0.9rem; line-height: 1.6;">
                            <li>‚úÖ Keywords from job description integrated throughout resume</li>
                            <li>‚úÖ Experience bullets reordered to emphasize ${matchedSkills.slice(0, 2).join(' and ') || 'relevant skills'}</li>
                            <li>‚úÖ Technical skills section optimized for ATS compatibility</li>
                            <li>‚úÖ Achievement metrics aligned with ${job.company}'s industry standards</li>
                            <li>‚úÖ Professional summary customized for ${job.title} role</li>
                            ${job.type === 'remote' ? '<li>‚úÖ Remote work experience highlighted</li>' : ''}
                        </ul>
                    </div>

                    <div style="background: #e8f0fe; padding: 15px; border-radius: 6px; border: 1px solid #667eea;">
                        <p style="margin: 0; color: #333;"><strong>üí° AI Recommendation:</strong> 
                        This tailored resume increases your application success rate by ${Math.min(job.matchScore + 25, 95)}%. 
                        ${matchedSkills.length > 0 ? 
                            `Strong alignment with ${matchedSkills.length} key requirements.` : 
                            'Consider gaining experience in the listed requirements to improve match score.'
                        }
                        ${job.matchScore > 70 ? ' üåü Excellent match - high recommendation to apply!' : ''}
                        </p>
                    </div>
                </div>
            `;
        }

        // Enhanced cover letter generation
        function generateCoverLetter() {
            const jobId = document.getElementById('tailoredResumeContent').dataset.jobId;
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;

            document.getElementById('coverLetterSection').style.display = 'block';
            document.getElementById('coverLetterContent').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>ü§ñ Generating personalized cover letter...</p>
                </div>
            `;

            setTimeout(() => {
                const coverLetter = createCoverLetter(job);
                document.getElementById('coverLetterContent').innerHTML = coverLetter;
                document.getElementById('downloadCoverLetterBtn').style.display = 'inline-block';
            }, 2500);
        }

        function createCoverLetter(job) {
            const matchedSkills = job.requirements ? 
                job.requirements.filter(req => resumeText.toLowerCase().includes(req.toLowerCase())) : [];

            return `
                <div style="font-family: 'Times New Roman', serif; line-height: 1.8; color: #333;">
                    <div style="margin-bottom: 30px;">
                        <div style="text-align: right; color: #666; margin-bottom: 20px;">
                            ${new Date().toLocaleDateString()}
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <strong>Hiring Manager</strong><br>
                            ${job.company}<br>
                            ${job.location}
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <strong>Subject: Application for ${job.title} Position</strong>
                        </div>
                    </div>

                    <p><strong>Dear Hiring Manager,</strong></p>
                    
                    <p>I am writing to express my strong interest in the ${job.title} position at ${job.company}. 
                    With my extensive background in software development and proven expertise in 
                    ${matchedSkills.slice(0, 3).join(', ')}, I am confident that I would be a valuable 
                    addition to your team.</p>
                    
                    <p>In my previous roles, I have successfully delivered scalable software solutions 
                    using technologies that directly align with your requirements. My experience includes:</p>
                    
                    <ul>
                        ${matchedSkills.slice(0, 4).map(skill => 
                            `<li>Hands-on expertise with <strong>${skill}</strong> in production environments</li>`
                        ).join('')}
                        <li>Strong problem-solving abilities and attention to code quality</li>
                        <li>Experience collaborating with cross-functional teams in ${job.type === 'remote' ? 'remote and distributed' : 'collaborative'} environments</li>
                    </ul>
                    
                    <p>What particularly attracts me to ${job.company} is your commitment to innovation 
                    and technical excellence. I am excited about the opportunity to contribute to your team's 
                    success while continuing to grow my skills in ${matchedSkills[0] || 'cutting-edge technologies'}.</p>
                    
                    <p>I would welcome the opportunity to discuss how my background in 
                    ${matchedSkills.slice(0, 2).join(' and ')} can contribute to ${job.company}'s continued success. 
                    Thank you for considering my application. I look forward to hearing from you soon.</p>
                    
                    <div style="margin-top: 30px;">
                        <p>Sincerely,<br>
                        <strong>John Doe</strong><br>
                        <span style="color: #666; font-size: 0.9rem;">
                            Email: john.doe@email.com<br>
                            Phone: (555) 123-4567
                        </span></p>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 15px; margin-top: 20px; border-left: 4px solid #667eea; border-radius: 0 6px 6px 0;">
                        <small><strong>ü§ñ AI Generated:</strong> This cover letter has been personalized based on your resume and the job requirements. 
                        Match score: <strong style="color: #28a745;">${job.matchScore}%</strong></small>
                    </div>
                </div>
            `;
        }

        function downloadTailoredResume() {
            const content = document.getElementById('tailoredResumeContent').innerText;
            downloadTextFile(content, 'tailored_resume.txt');
            showNotification('Tailored resume downloaded! üì•', 'success');
        }

        function downloadCoverLetter() {
            const content = document.getElementById('coverLetterContent').innerText;
            downloadTextFile(content, 'cover_letter.txt');
            showNotification('Cover letter downloaded! üì•', 'success');
        }

        function downloadTextFile(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function closeTailoredResumeModal() {
            document.getElementById('tailoredResumeModal').style.display = 'none';
            document.getElementById('coverLetterSection').style.display = 'none';
        }

        // Enhanced drag and drop functionality
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('resumeUploadArea');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            uploadArea.addEventListener('drop', handleDrop, false);

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            function highlight(e) {
                uploadArea.classList.add('dragover');
            }

            function unhighlight(e) {
                uploadArea.classList.remove('dragover');
            }

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    const input = document.getElementById('resumeFile');
                    input.files = files;
                    handleFileUpload(input);
                }
            }
        }

        // Enhanced search functionality with progress
        async function searchJobs() {
            const query = document.getElementById('jobQuery').value;
            const location = document.getElementById('locationQuery').value;
            const jobType = document.getElementById('jobTypeFilter').value;

            showLoadingWithProgress();
            showNotification(`Searching for ${query || 'all'} jobs${location ? ' in ' + location : ''}...`, 'info');

            try {
                // Simulate search progress
                await simulateProgress();

                const api = JOB_APIS[currentSource];
                if (!api.enabled) {
                    throw new Error(`${api.name} is not yet available`);
                }

                let jobs = await api.fetch(query, location);
                
                // Enhanced filtering
                jobs = applyFilters(jobs, { query, location, jobType });
                
                allJobs = jobs;
                filteredJobs = jobs;
                
                // Calculate match scores if resume is uploaded
                if (uploadedResume) {
                    calculateMatchScores();
                }
                
                // Apply sorting
                applySorting();
                
                renderJobs(filteredJobs);
                updateJobStats();
                
                showNotification(`Found ${jobs.length} jobs matching your criteria!`, 'success');
                
            } catch (error) {
                console.error('Search error:', error);
                showNotification('Error searching jobs: ' + error.message, 'error');
                renderJobs([]);
                updateJobStats();
            }
        }

        function applyFilters(jobs, filters) {
            let filtered = jobs;

            // Text search
            if (filters.query) {
                const searchTerm = filters.query.toLowerCase();
                filtered = filtered.filter(job => 
                    job.title.toLowerCase().includes(searchTerm) ||
                    job.company.toLowerCase().includes(searchTerm) ||
                    job.description.toLowerCase().includes(searchTerm) ||
                    (job.requirements && job.requirements.some(req => 
                        req.toLowerCase().includes(searchTerm)
                    ))
                );
            }

            // Location filter
            if (filters.location) {
                const locationTerm = filters.location.toLowerCase();
                filtered = filtered.filter(job => 
                    job.location.toLowerCase().includes(locationTerm)
                );
            }

            // Job type filter
            if (filters.jobType) {
                filtered = filtered.filter(job => job.type === filters.jobType);
            }

            // Salary range filter
            const minSalary = parseInt(document.getElementById('minSalary').value);
            const maxSalary = parseInt(document.getElementById('maxSalary').value);
            
            filtered = filtered.filter(job => {
                if (!job.salaryMin || !job.salaryMax) return true;
                return job.salaryMax >= minSalary && job.salaryMin <= maxSalary;
            });

            return filtered;
        }

        function applySorting() {
            const sortBy = document.getElementById('sortBy').value;
            
            filteredJobs.sort((a, b) => {
                switch (sortBy) {
                    case 'match':
                        return b.matchScore - a.matchScore;
                    case 'date':
                        return new Date(b.posted) - new Date(a.posted);
                    case 'salary':
                        return (b.salaryMax || 0) - (a.salaryMax || 0);
                    case 'company':
                        return a.company.localeCompare(b.company);
                    default:
                        return 0;
                }
            });
        }

        function showLoadingWithProgress() {
            document.getElementById('jobsContainer').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p id="searchStatus">üîç Initializing job search...</p>
                </div>
            `;
            
            // Reset progress bar
            document.getElementById('searchProgress').style.width = '0%';
        }

        async function simulateProgress() {
            const steps = [
                'Connecting to job boards...',
                'Analyzing job requirements...',
                'Filtering by location and type...',
                'Calculating match scores...',
                'Sorting results...',
                'Finalizing search results...'
            ];

            for (let i = 0; i < steps.length; i++) {
                await new Promise(resolve => setTimeout(resolve, 300));
                document.getElementById('searchStatus').textContent = steps[i];
                document.getElementById('searchProgress').style.width = `${((i + 1) / steps.length) * 100}%`;
            }
        }

        function renderJobs(jobs) {
            const container = document.getElementById('jobsContainer');
            
            if (jobs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 40px 20px; color: #6c757d;">
                        <h3>üîç No jobs found</h3>
                        <p>Try adjusting your search criteria or filters.</p>
                        <div style="margin-top: 20px;">
                            <strong>Tips:</strong>
                            <ul style="list-style: none; padding: 0; margin-top: 10px;">
                                <li>üéØ Use broader keywords</li>
                                <li>üìç Try different locations</li>
                                <li>üí∞ Adjust salary range</li>
                                <li>üìÑ Upload resume for better matches</li>
                            </ul>
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = jobs.map(job => `
                <div class="job-card" data-match-score="${job.matchScore}">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                        <div class="job-source">${job.source}${job.isReal ? '<span class="real-job-badge">REAL JOB</span>' : ''}</div>
                        ${uploadedResume && job.matchScore > 0 ? `<div class="match-score">${job.matchScore}% Match</div>` : ''}
                    </div>
                    
                    <div class="job-title" style="font-size: 1.3rem; font-weight: bold; color: #333; margin-bottom: 8px;">
                        ${job.title}
                    </div>
                    
                    <div class="job-company" style="font-size: 1.1rem; color: #667eea; margin-bottom: 8px;">
                        ${job.company}
                    </div>
                    
                    <div class="job-meta" style="color: #6c757d; margin-bottom: 12px;">
                        üìç ${job.location} ‚Ä¢ 
                        ${job.type.charAt(0).toUpperCase() + job.type.slice(1).replace('-', ' ')} ‚Ä¢ 
                        Posted ${formatDate(job.posted)}
                    </div>
                    
                    <div class="job-meta" style="color: #6c757d; margin-bottom: 12px;">
                        üí∞ ${job.salary}
                    </div>
                    
                    <div class="job-description" style="color: #495057; line-height: 1.6; margin-bottom: 15px;">
                        ${truncateText(job.description, 200)}
                    </div>
                    
                    ${job.requirements ? `
                        <div class="job-requirements" style="margin-bottom: 15px;">
                            <strong style="color: #667eea; font-size: 0.9rem;">Required Skills:</strong>
                            <div style="margin-top: 5px;">
                                ${job.requirements.slice(0, 6).map(req => {
                                    const isMatched = uploadedResume && resumeText.toLowerCase().includes(req.toLowerCase());
                                    return `<span style="
                                        background: ${isMatched ? '#28a745' : '#6c757d'}; 
                                        color: white; 
                                        padding: 2px 8px; 
                                        border-radius: 12px; 
                                        font-size: 0.75rem; 
                                        margin: 2px; 
                                        display: inline-block;
                                        ${isMatched ? 'font-weight: bold;' : ''}
                                    ">${req}${isMatched ? ' ‚úì' : ''}</span>`;
                                }).join('')}
                                ${job.requirements.length > 6 ? `<span style="color: #6c757d; font-size: 0.8rem;">+${job.requirements.length - 6} more</span>` : ''}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="job-actions" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="viewJobDetails('${job.id}')" style="padding: 8px 16px; font-size: 14px;">
                            üìã View Details
                        </button>
                        <button class="btn btn-primary" onclick="tailorResumeForJob('${job.id}')" style="padding: 8px 16px; font-size: 14px;" ${!uploadedResume ? 'disabled title="Upload resume first"' : ''}>
                            ${uploadedResume ? 'üéØ Tailor Resume' : 'üìÑ Upload Resume First'}
                        </button>
                        <button class="btn btn-success" onclick="window.open('${job.url}', '_blank')" style="padding: 8px 16px; font-size: 14px;">
                            üöÄ Apply Now
                        </button>
                    </div>
                </div>
            `).join('');

            // Complete progress bar
            document.getElementById('searchProgress').style.width = '100%';
        }

        function updateJobStats() {
            const totalJobs = allJobs.length;
            const matchingJobs = filteredJobs.length;
            const remoteJobs = filteredJobs.filter(job => job.type === 'remote').length;
            const avgMatch = filteredJobs.length > 0 ? 
                Math.round(filteredJobs.reduce((sum, job) => sum + job.matchScore, 0) / filteredJobs.length) : 0;

            document.getElementById('totalJobs').textContent = totalJobs;
            document.getElementById('matchingJobs').textContent = matchingJobs;
            document.getElementById('avgMatch').textContent = uploadedResume ? `${avgMatch}%` : '0%';
            document.getElementById('remoteJobs').textContent = remoteJobs;
        }

        function viewJobDetails(jobId) {
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;

            const matchInfo = uploadedResume ? `\n\nüéØ Match Score: ${job.matchScore}%` : '';
            const benefits = job.benefits ? `\n\nüíº Benefits:\n${job.benefits.join(', ')}` : '';

            alert(`üìã Job Details

üìå ${job.title}
üè¢ ${job.company}
üìç ${job.location}
üíº ${job.type.charAt(0).toUpperCase() + job.type.slice(1).replace('-', ' ')}
üí∞ ${job.salary}

üìù Description:
${job.description}

üîß Requirements:
${job.requirements ? job.requirements.join(', ') : 'See job posting for details'}${benefits}

üìÖ Posted: ${formatDate(job.posted)}
üîó Source: ${job.source}${matchInfo}`);
        }

        // Enhanced filter event listeners
        function setupFilters() {
            const minSalarySlider = document.getElementById('minSalary');
            const maxSalarySlider = document.getElementById('maxSalary');
            const minSalaryLabel = document.getElementById('minSalaryLabel');
            const maxSalaryLabel = document.getElementById('maxSalaryLabel');
            const sortSelect = document.getElementById('sortBy');

            // Salary slider updates
            minSalarySlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                minSalaryLabel.textContent = `${value / 1000}k`;
                
                // Ensure min doesn't exceed max
                if (value >= parseInt(maxSalarySlider.value)) {
                    maxSalarySlider.value = value + 10000;
                    maxSalaryLabel.textContent = `${(value + 10000) / 1000}k`;
                }
                
                applyFiltersAndRender();
            });

            maxSalarySlider.addEventListener('input', (e) => {
                const value = parseInt(e.target.value);
                maxSalaryLabel.textContent = `${value / 1000}k`;
                
                // Ensure max doesn't go below min
                if (value <= parseInt(minSalarySlider.value)) {
                    minSalarySlider.value = value - 10000;
                    minSalaryLabel.textContent = `${(value - 10000) / 1000}k`;
                }
                
                applyFiltersAndRender();
            });

            // Sort change
            sortSelect.addEventListener('change', () => {
                applySorting();
                renderJobs(filteredJobs);
            });

            // Job type filter
            document.getElementById('jobTypeFilter').addEventListener('change', applyFiltersAndRender);
        }

        function applyFiltersAndRender() {
            if (allJobs.length === 0) return;

            const query = document.getElementById('jobQuery').value;
            const location = document.getElementById('locationQuery').value;
            const jobType = document.getElementById('jobTypeFilter').value;

            filteredJobs = applyFilters(allJobs, { query, location, jobType });
            applySorting();
            renderJobs(filteredJobs);
            updateJobStats();
        }

        // Future API implementations (placeholders)
        async function fetchIndeedJobs(query, location) {
            showNotification('Indeed API integration coming soon! üöÄ', 'info');
            return [];
        }

        async function fetchGitHubJobs(query, location) {
            showNotification('GitHub Jobs API integration coming soon! üíª', 'info');
            return [];
        }

        async function fetchLinkedInJobs(query, location) {
            showNotification('LinkedIn API integration coming soon! üíº', 'info');
            return [];
        }

        // Utility functions
        function formatDate(date) {
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) return '1 day ago';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            return `${Math.floor(diffDays / 30)} months ago`;
        }

        function truncateText(text, maxLength) {
            return text.length <= maxLength ? text : text.substring(0, maxLength) + '...';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>${getNotificationIcon(type)}</span>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 4000);
        }

        function getNotificationIcon(type) {
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                info: '‚ÑπÔ∏è',
                warning: '‚ö†Ô∏è'
            };
            return icons[type] || icons.info;
        }

        // API source selector
        function setupAPISelector() {
            const apiOptions = document.querySelectorAll('.api-option');
            apiOptions.forEach(option => {
                option.addEventListener('click', () => {
                    if (option.classList.contains('coming-soon')) {
                        showNotification('This API integration is coming soon! üöÄ', 'info');
                        return;
                    }
                    
                    apiOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    currentSource = option.dataset.source;
                    updateAPIStatus();
                });
            });
        }

        function updateAPIStatus() {
            const statusEl = document.getElementById('apiStatus');
            const api = JOB_APIS[currentSource];
            
            if (api.enabled) {
                statusEl.className = 'api-status online';
                statusEl.innerHTML = `‚úÖ Connected to ${api.name} - Ready to search real jobs!`;
            } else {
                statusEl.className = 'api-status offline';
                statusEl.innerHTML = `üîß Currently using enhanced demo data - Real job APIs coming soon!`;
            }
        }

        // Keyboard shortcuts
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + Enter to search
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    searchJobs();
                }
                
                // Escape to close modals
                if (e.key === 'Escape') {
                    closeResumeModal();
                    closeTailoredResumeModal();
                }
            });
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const resumeModal = document.getElementById('resumeModal');
            const tailoredModal = document.getElementById('tailoredResumeModal');
            
            if (event.target === resumeModal) {
                resumeModal.style.display = 'none';
            }
            if (event.target === tailoredModal) {
                tailoredModal.style.display = 'none';
                document.getElementById('coverLetterSection').style.display = 'none';
            }
        }

        // Enhanced initialization
        function initializeApp() {
            console.log('üöÄ Initializing Enhanced AI Job Search Assistant...');
            
            setupAPISelector();
            setupDragAndDrop();
            setupFilters();
            setupKeyboardShortcuts();
            updateAPIStatus();
            
            // Setup event listeners
            document.getElementById('jobQuery').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchJobs();
            });

            document.getElementById('locationQuery').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchJobs();
            });

            // Real-time search as user types (with debounce)
            let searchTimeout;
            [document.getElementById('jobQuery'), document.getElementById('locationQuery')].forEach(input => {
                input.addEventListener('input', () => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        if (allJobs.length > 0) {
                            applyFiltersAndRender();
                        }
                    }, 500);
                });
            });

            // Initial load
            searchJobs();
            
            console.log('‚úÖ Enhanced Job Search Assistant ready!');
            showNotification('üöÄ Enhanced AI Job Search Assistant loaded! Upload your resume for personalized matching.', 'success');
        }

        // Performance monitoring
        function logPerformanceMetrics() {
            if (performance.mark) {
                performance.mark('app-ready');
                console.log('üìä App Performance Metrics:');
                console.log(`- Initial Load: ${performance.now().toFixed(2)}ms`);
                console.log(`- Jobs Loaded: ${allJobs.length}`);
                console.log(`- Resume Status: ${uploadedResume ? 'Uploaded' : 'Not uploaded'}`);
            }
        }

        // Start the enhanced app
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
            setTimeout(logPerformanceMetrics, 1000);
        });

        // Service worker for offline functionality (future enhancement)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Service worker registration would go here
                console.log('üîß Service worker support detected (offline mode coming soon)');
            });
        }
    </script>
</body>
</html> 'Remote Work', '401k Matching', 'Learning Budget'],
                    posted: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job1',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-2',
                    title: 'Full Stack Developer',
                    company: 'StartupXYZ',
                    location: 'Remote',
                    type: 'remote',
                    salary: '$95,000 - $135,000',
                    salaryMin: 95000,
                    salaryMax: 135000,
                    description: 'Build scalable web applications from frontend to backend. Work with Node.js, React, and cloud technologies in a fast-paced startup environment with significant growth opportunities.',
                    requirements: ['Node.js', 'React', 'MongoDB', 'AWS', 'JavaScript', 'REST APIs', 'Docker'],
                    benefits: ['Equity', 'Flexible Hours', 'Health Insurance', 'Home Office Setup'],
                    posted: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job2',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-3',
                    title: 'React Developer',
                    company: 'InnovateLab',
                    location: 'Remote',
                    type: 'remote',
                    salary: '$80,000 - $120,000',
                    salaryMin: 80000,
                    salaryMax: 120000,
                    description: 'Focus exclusively on React development for cutting-edge applications. Work with the latest React features, hooks, and ecosystem tools to create exceptional user experiences.',
                    requirements: ['React', 'Redux', 'Next.js', 'TypeScript', 'Testing', 'GraphQL', 'Webpack'],
                    benefits: ['Remote First', 'Professional Development', 'Health Insurance', 'Unlimited PTO'],
                    posted: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job3',
                    isReal: false,
                    matchScore: 0
                },
                {
                    id: 'demo-4',
                    title: 'Software Engineer',
                    company: 'Enterprise Corp',
                    location: 'New York, NY',
                    type: 'full-time',
                    salary: '$105,000 - $145,000',
                    salaryMin: 105000,
                    salaryMax: 145000,
                    description: 'Develop enterprise software solutions using Java and Spring. Work on large-scale distributed systems serving millions of users with high availability requirements.',
                    requirements: ['Java', 'Spring Boot', 'Microservices', 'Docker', 'Kubernetes', 'SQL', 'Redis'],
                    benefits: ['Health Insurance',