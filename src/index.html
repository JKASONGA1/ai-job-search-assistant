<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Job Search Assistant - Production</title>
    <meta name="description" content="Find real jobs with AI-powered resume tailoring and professional cover letters">
    
    <!-- SEO and Social Media Meta Tags -->
    <meta property="og:title" content="AI Job Search Assistant">
    <meta property="og:description" content="Find your dream job with AI-powered resume tailoring and cover letter generation">
    <meta property="og:url" content="https://jkasonga1.github.io/ai-job-search-assistant/">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="AI Job Search Assistant">
    <meta name="twitter:description" content="Find your dream job with AI-powered tools">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🤖</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .beta-badge {
            background: #ff6b6b;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .api-status {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px 15px;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            font-size: 0.9rem;
        }

        .api-status.online {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .api-status.offline {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .jobs-container {
            max-height: 600px;
            overflow-y: auto;
        }

        .job-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .job-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .job-source {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-bottom: 10px;
        }

        .real-job-badge {
            background: #28a745;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            margin-left: 10px;
        }

        /* Resume Upload Styles */
        .resume-upload-area {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .resume-upload-area:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .resume-upload-area.dragover {
            border-color: #667eea;
            background: #e8f0fe;
        }

        .resume-uploaded {
            background: #d4edda;
            border-color: #28a745;
        }

        .resume-info {
            background: #e8f0fe;
            border: 1px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .resume-preview {
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .file-input {
            display: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }
        .notification.info { background: #17a2b8; }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .api-selector {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .api-selector label {
            color: white;
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
        }

        .api-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .api-option {
            background: white;
            border-radius: 6px;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .api-option.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .api-option:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .feature-announcement {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .ats-score {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .ats-score.warning {
            background: linear-gradient(135deg, #ffc107, #fd7e14);
        }

        .ats-score.danger {
            background: linear-gradient(135deg, #dc3545, #e83e8c);
        }

        .ats-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .ats-issue {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .ats-issue.critical {
            background: #f8d7da;
            border-color: #f5c6cb;
        }

        .ats-issue.warning {
            background: #fff3cd;
            border-color: #ffeaa7;
        }

        .ats-issue.success {
            background: #d4edda;
            border-color: #c3e6cb;
        }

        .ats-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .ats-keyword {
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .ats-keyword.found {
            background: #d4edda;
            color: #155724;
        }

        .ats-keyword.missing {
            background: #f8d7da;
            color: #721c24;
        }

        .coming-soon::after {
            content: "🔜 Coming Soon";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffc107;
            color: #000;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 15px;
        }

        .close:hover {
            color: #000;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .search-bar {
                flex-direction: column;
            }
            
            .api-options {
                flex-direction: column;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>🤖 AI Job Search Assistant<span class="beta-badge">BETA</span></h1>
            <p>Find real jobs with AI-powered resume tailoring & cover letters</p>
        </header>

        <div class="feature-announcement">
            <strong>🚀 Now with Resume Upload!</strong> Upload your resume to get personalized job matching and tailoring.
        </div>

        <div class="api-selector">
            <label>Choose Your Job Search Source:</label>
            <div class="api-options">
                <div class="api-option selected" data-source="demo">
                    <strong>📋 Demo Jobs</strong><br>
                    <small>6 sample positions for testing</small>
                </div>
                <div class="api-option coming-soon" data-source="indeed">
                    <strong>🔍 Indeed API</strong><br>
                    <small>Real jobs from Indeed</small>
                </div>
                <div class="api-option coming-soon" data-source="github">
                    <strong>💻 GitHub Jobs</strong><br>
                    <small>Tech positions from GitHub</small>
                </div>
                <div class="api-option coming-soon" data-source="linkedin">
                    <strong>💼 LinkedIn API</strong><br>
                    <small>Professional network jobs</small>
                </div>
            </div>
        </div>

        <div id="apiStatus" class="api-status offline">
            🔧 Currently using demo data - Real job APIs coming soon!
        </div>

        <!-- Resume Upload Section -->
        <div class="card">
            <h3>📄 Resume Upload & ATS Testing</h3>
            <div id="resumeUploadArea" class="resume-upload-area" onclick="document.getElementById('resumeFile').click()">
                <div id="uploadPrompt">
                    <div style="font-size: 2rem; margin-bottom: 10px;">📄</div>
                    <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Upload Your Resume</div>
                    <div style="color: #6c757d; margin-bottom: 15px;">
                        Drag & drop your resume here or click to browse<br>
                        <small>Supports PDF, DOC, DOCX, TXT files (max 5MB)</small>
                    </div>
                    <button class="btn btn-primary" type="button">Choose File</button>
                </div>
                <div id="uploadedResume" style="display: none;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">✅</div>
                    <div style="font-size: 1.2rem; font-weight: 600; color: #28a745; margin-bottom: 10px;">Resume Uploaded Successfully!</div>
                    <div id="resumeFileName" style="color: #6c757d; margin-bottom: 15px;"></div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button class="btn btn-secondary" onclick="viewResumePreview()">Preview</button>
                        <button class="btn btn-primary" onclick="runATSTest()">🔍 ATS Test</button>
                        <button class="btn btn-danger" onclick="removeResume()">Remove</button>
                    </div>
                </div>
            </div>
            <input type="file" id="resumeFile" class="file-input" accept=".pdf,.doc,.docx,.txt" onchange="handleFileUpload(this)">
            <div id="resumeInfo" class="resume-info" style="display: none;">
                <div><strong>File:</strong> <span id="fileName"></span></div>
                <div><strong>Size:</strong> <span id="fileSize"></span></div>
                <div><strong>Type:</strong> <span id="fileType"></span></div>
                <div><strong>Uploaded:</strong> <span id="uploadDate"></span></div>
            </div>
        </div>

        <div class="card">
            <h3>🔍 Job Search</h3>
            <div class="search-bar">
                <input type="text" id="jobQuery" class="search-input" placeholder="Job title or keywords (e.g., React Developer)">
                <input type="text" id="locationQuery" class="search-input" placeholder="Location (e.g., Remote, San Francisco)">
                <select id="jobTypeFilter" class="search-input" style="flex: 0.5;">
                    <option value="">All Types</option>
                    <option value="full-time">Full Time</option>
                    <option value="part-time">Part Time</option>
                    <option value="remote">Remote</option>
                    <option value="contract">Contract</option>
                </select>
                <button class="btn btn-primary" onclick="searchJobs()">🔍 Search Jobs</button>
            </div>
        </div>

        <div class="card">
            <h3>💼 Job Listings</h3>
            <div id="jobsContainer" class="jobs-container">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>🔄 Loading job opportunities...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ATS Test Results Modal -->
    <div id="atsTestModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeATSModal()">&times;</span>
            <h2>🔍 ATS Compatibility Test Results</h2>
            <div id="atsTestContent">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>🤖 Analyzing your resume for ATS compatibility...</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Resume Preview Modal -->
    <div id="resumeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeResumeModal()">&times;</span>
            <h2>📄 Resume Preview</h2>
            <div id="resumePreviewContent" class="resume-preview">
                Loading resume preview...
            </div>
        </div>
    </div>

    <!-- Tailored Resume Modal -->
    <div id="tailoredResumeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeTailoredResumeModal()">&times;</span>
            <h2>🎯 Tailored Resume</h2>
            <div id="tailoredResumeContent" style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-top: 15px;">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>🤖 AI is tailoring your resume for this position...</p>
                </div>
            </div>
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-primary" onclick="downloadTailoredResume()" style="display: none;" id="downloadTailoredBtn">📥 Download Tailored Resume</button>
            </div>
        </div>
    </div>

    <script>
        console.log('🚀 AI Job Search Assistant - Production Mode');

        // Application state
        let currentSource = 'demo';
        let allJobs = [];
        let uploadedResume = null;
        let resumeText = '';

        // Configuration for different job APIs
        const JOB_APIS = {
            demo: {
                name: 'Demo Jobs',
                enabled: true,
                fetch: () => Promise.resolve(getDemoJobs())
            },
            indeed: {
                name: 'Indeed API',
                enabled: false,
                fetch: (query, location) => fetchIndeedJobs(query, location)
            },
            github: {
                name: 'GitHub Jobs',
                enabled: false,
                fetch: (query, location) => fetchGitHubJobs(query, location)
            },
            linkedin: {
                name: 'LinkedIn API', 
                enabled: false,
                fetch: (query, location) => fetchLinkedInJobs(query, location)
            }
        };

        // Demo jobs data
        function getDemoJobs() {
            return [
                {
                    id: 'demo-1',
                    title: 'Senior Frontend Developer',
                    company: 'TechFlow Inc.',
                    location: 'San Francisco, CA',
                    type: 'full-time',
                    salary: '$120,000 - $160,000',
                    description: 'Join our dynamic team building next-generation web applications with React, TypeScript, and modern tools. Lead frontend architecture decisions and mentor junior developers.',
                    requirements: ['React', 'TypeScript', 'JavaScript', 'HTML/CSS', 'Git', 'Agile'],
                    posted: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job1',
                    isReal: false
                },
                {
                    id: 'demo-2',
                    title: 'Full Stack Developer',
                    company: 'StartupXYZ',
                    location: 'Remote',
                    type: 'remote',
                    salary: '$95,000 - $135,000',
                    description: 'Build scalable web applications from frontend to backend. Work with Node.js, React, and cloud technologies in a fast-paced startup environment.',
                    requirements: ['Node.js', 'React', 'MongoDB', 'AWS', 'JavaScript', 'REST APIs'],
                    posted: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job2',
                    isReal: false
                },
                {
                    id: 'demo-3',
                    title: 'React Developer',
                    company: 'InnovateLab',
                    location: 'Remote',
                    type: 'remote',
                    salary: '$80,000 - $120,000',
                    description: 'Focus exclusively on React development for cutting-edge applications. Work with the latest React features and ecosystem.',
                    requirements: ['React', 'Redux', 'Next.js', 'TypeScript', 'Testing', 'GraphQL'],
                    posted: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job3',
                    isReal: false
                },
                {
                    id: 'demo-4',
                    title: 'Software Engineer',
                    company: 'Enterprise Corp',
                    location: 'New York, NY',
                    type: 'full-time',
                    salary: '$105,000 - $145,000',
                    description: 'Develop enterprise software solutions using Java and Spring. Work on large-scale distributed systems serving millions of users.',
                    requirements: ['Java', 'Spring Boot', 'Microservices', 'Docker', 'Kubernetes', 'SQL'],
                    posted: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job4',
                    isReal: false
                },
                {
                    id: 'demo-5',
                    title: 'DevOps Engineer',
                    company: 'CloudTech Solutions',
                    location: 'Seattle, WA',
                    type: 'full-time',
                    salary: '$130,000 - $170,000',
                    description: 'Manage cloud infrastructure and deployment pipelines. Expertise in AWS, Docker, and automation tools required.',
                    requirements: ['AWS', 'Docker', 'Kubernetes', 'Terraform', 'Jenkins', 'Python'],
                    posted: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job5',
                    isReal: false
                },
                {
                    id: 'demo-6',
                    title: 'Frontend Developer',
                    company: 'Creative Studios',
                    location: 'Austin, TX', 
                    type: 'part-time',
                    salary: '$65,000 - $85,000',
                    description: 'Create stunning user interfaces for creative projects. Strong focus on design implementation and user experience.',
                    requirements: ['HTML', 'CSS', 'JavaScript', 'Vue.js', 'Figma', 'Responsive Design'],
                    posted: new Date(Date.now() - 6 * 24 * 60 * 60 * 1000),
                    source: 'Demo',
                    url: 'https://example.com/job6',
                    isReal: false
                }
            ];
        }

        // Resume upload functionality
        function handleFileUpload(input) {
            const file = input.files[0];
            if (!file) return;

            // Validate file
            if (!validateFile(file)) return;

            uploadedResume = file;
            showResumeUploaded(file);
            processResume(file);
        }

        function validateFile(file) {
            const maxSize = 5 * 1024 * 1024; // 5MB
            const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];

            if (file.size > maxSize) {
                showNotification('File too large. Please upload a file smaller than 5MB.', 'error');
                return false;
            }

            if (!allowedTypes.includes(file.type)) {
                showNotification('Unsupported file type. Please upload PDF, DOC, DOCX, or TXT files.', 'error');
                return false;
            }

            return true;
        }

        function showResumeUploaded(file) {
            document.getElementById('uploadPrompt').style.display = 'none';
            document.getElementById('uploadedResume').style.display = 'block';
            document.getElementById('resumeUploadArea').classList.add('resume-uploaded');
            
            document.getElementById('resumeFileName').textContent = file.name;
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('fileType').textContent = file.type;
            document.getElementById('uploadDate').textContent = new Date().toLocaleString();
            document.getElementById('resumeInfo').style.display = 'block';

            showNotification('Resume uploaded successfully! 🎉', 'success');
        }

        async function processResume(file) {
            try {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // For demo purposes, we'll extract basic text
                    // In a real app, you'd use proper PDF/DOC parsing libraries
                    if (file.type === 'text/plain') {
                        resumeText = e.target.result;
                    } else {
                        // Simplified extraction for demo
                        resumeText = `Resume content for ${file.name} (${formatFileSize(file.size)})
                        
This is a demo preview. In a production app, the actual resume content would be extracted and parsed here.

Skills likely include: JavaScript, React, Node.js, HTML, CSS, Git, etc.
Experience: Software development and web technologies
Education: Computer Science or related field

The AI would analyze this content to match against job requirements and tailor applications accordingly.`;
                    }
                };
                reader.readAsText(file);
            } catch (error) {
                console.error('Error processing resume:', error);
                showNotification('Error processing resume. Please try again.', 'error');
            }
        }

        // ATS Testing functionality
        function runATSTest() {
            if (!uploadedResume || !resumeText) {
                showNotification('Please upload your resume first to run ATS testing.', 'error');
                return;
            }

            document.getElementById('atsTestModal').style.display = 'block';
            
            // Simulate ATS analysis processing
            setTimeout(() => {
                const atsResults = performATSAnalysis(resumeText);
                displayATSResults(atsResults);
            }, 3000);
        }

        function performATSAnalysis(resumeText) {
            const text = resumeText.toLowerCase();
            
            // ATS Compatibility Checks
            const checks = {
                formatting: checkFormatting(text),
                keywords: analyzeKeywords(text),
                sections: checkSections(text),
                contact: checkContactInfo(text),
                readability: checkReadability(text),
                fileFormat: checkFileFormat(),
                length: checkResumeLength(text)
            };

            // Calculate overall score
            const totalChecks = Object.keys(checks).length;
            const passedChecks = Object.values(checks).filter(check => check.passed).length;
            const score = Math.round((passedChecks / totalChecks) * 100);

            return {
                score: score,
                checks: checks,
                recommendations: generateRecommendations(checks),
                keywords: extractKeywords(text)
            };
        }

        function checkFormatting(text) {
            const issues = [];
            let score = 100;

            // Check for complex formatting indicators
            if (text.includes('│') || text.includes('┌') || text.includes('└')) {
                issues.push('Tables and complex borders may not parse correctly in ATS');
                score -= 20;
            }

            if (text.includes('●') || text.includes('•')) {
                // This is actually good for ATS
            } else {
                issues.push('Consider using bullet points (• or -) for better readability');
                score -= 10;
            }

            return {
                passed: score >= 80,
                score: score,
                issues: issues,
                category: 'Formatting'
            };
        }

        function analyzeKeywords(text) {
            const commonSkills = [
                'javascript', 'react', 'node.js', 'python', 'java', 'html', 'css',
                'management', 'leadership', 'communication', 'teamwork', 'agile',
                'project management', 'data analysis', 'sql', 'git', 'aws'
            ];

            const foundKeywords = commonSkills.filter(skill => 
                text.includes(skill) || text.includes(skill.replace('.', ''))
            );

            const keywordDensity = foundKeywords.length / commonSkills.length * 100;

            return {
                passed: keywordDensity >= 30,
                score: Math.min(keywordDensity * 2, 100),
                foundKeywords: foundKeywords,
                missingKeywords: commonSkills.filter(skill => !foundKeywords.includes(skill)),
                category: 'Keywords & Skills'
            };
        }

        function checkSections(text) {
            const requiredSections = [
                { name: 'Contact Information', keywords: ['email', 'phone', '@'] },
                { name: 'Experience/Work History', keywords: ['experience', 'work', 'employed', 'position'] },
                { name: 'Skills', keywords: ['skills', 'technologies', 'proficient'] },
                { name: 'Education', keywords: ['education', 'degree', 'university', 'college'] }
            ];

            const foundSections = requiredSections.filter(section =>
                section.keywords.some(keyword => text.includes(keyword))
            );

            return {
                passed: foundSections.length >= 3,
                score: (foundSections.length / requiredSections.length) * 100,
                foundSections: foundSections.map(s => s.name),
                missingSections: requiredSections
                    .filter(section => !foundSections.includes(section))
                    .map(s => s.name),
                category: 'Resume Sections'
            };
        }

        function checkContactInfo(text) {
            const hasEmail = /@/.test(text);
            const hasPhone = /\d{3}[-.]?\d{3}[-.]?\d{4}/.test(text) || /\(\d{3}\)/.test(text);
            
            let score = 0;
            const issues = [];

            if (hasEmail) score += 50;
            else issues.push('Email address not detected');

            if (hasPhone) score += 50;
            else issues.push('Phone number not detected');

            return {
                passed: score >= 50,
                score: score,
                issues: issues,
                category: 'Contact Information'
            };
        }

        function checkReadability(text) {
            const words = text.split(/\s+/).length;
            const sentences = text.split(/[.!?]+/).length;
            const avgWordsPerSentence = words / sentences;

            let score = 100;
            const issues = [];

            if (avgWordsPerSentence > 25) {
                issues.push('Consider shorter sentences for better ATS parsing');
                score -= 20;
            }

            if (text.length < 200) {
                issues.push('Resume content seems too brief');
                score -= 30;
            }

            return {
                passed: score >= 70,
                score: score,
                issues: issues,
                category: 'Readability'
            };
        }

        function checkFileFormat() {
            const format = uploadedResume ? uploadedResume.type : 'unknown';
            let score = 100;
            const issues = [];

            if (format === 'application/pdf') {
                // PDF is generally good for ATS
            } else if (format.includes('word') || format.includes('doc')) {
                // Word docs are also ATS-friendly
            } else {
                issues.push('Consider using PDF or Word format for better ATS compatibility');
                score -= 30;
            }

            return {
                passed: score >= 70,
                score: score,
                issues: issues,
                category: 'File Format'
            };
        }

        function checkResumeLength(text) {
            const wordCount = text.split(/\s+/).length;
            let score = 100;
            const issues = [];

            if (wordCount < 200) {
                issues.push('Resume may be too short - consider adding more detail');
                score -= 40;
            } else if (wordCount > 1000) {
                issues.push('Resume may be too long - consider condensing to 1-2 pages');
                score -= 20;
            }

            return {
                passed: score >= 80,
                score: score,
                wordCount: wordCount,
                issues: issues,
                category: 'Resume Length'
            };
        }

        function generateRecommendations(checks) {
            const recommendations = [];

            Object.values(checks).forEach(check => {
                if (!check.passed && check.issues) {
                    recommendations.push(...check.issues);
                }
            });

            // Add specific improvement suggestions
            recommendations.push(
                'Use standard section headers: Summary, Experience, Skills, Education',
                'Include relevant keywords from job descriptions',
                'Use consistent date formatting (MM/YYYY)',
                'Avoid images, graphics, and complex formatting',
                'Use standard fonts like Arial, Calibri, or Times New Roman'
            );

            return [...new Set(recommendations)]; // Remove duplicates
        }

        function extractKeywords(text) {
            const commonKeywords = [
                'leadership', 'management', 'communication', 'teamwork', 'problem-solving',
                'javascript', 'python', 'react', 'node.js', 'sql', 'aws', 'git',
                'agile', 'scrum', 'project management', 'data analysis', 'marketing'
            ];

            return commonKeywords.filter(keyword => 
                text.includes(keyword.toLowerCase())
            );
        }

        function displayATSResults(results) {
            const content = document.getElementById('atsTestContent');
            const scoreClass = results.score >= 80 ? 'success' : results.score >= 60 ? 'warning' : 'danger';
            
            content.innerHTML = `
                <div class="ats-score ${scoreClass}">
                    <div style="font-size: 2rem; margin-bottom: 10px;">
                        ${results.score >= 80 ? '✅' : results.score >= 60 ? '⚠️' : '❌'}
                    </div>
                    <div>ATS Compatibility Score: ${results.score}%</div>
                    <div style="font-size: 1rem; font-weight: normal; margin-top: 10px;">
                        ${results.score >= 80 ? 'Excellent! Your resume is highly ATS-friendly.' :
                          results.score >= 60 ? 'Good, but there\'s room for improvement.' :
                          'Needs significant improvements for ATS compatibility.'}
                    </div>
                </div>

                <div class="ats-section">
                    <h4 style="color: #667eea; margin-bottom: 15px;">📊 Detailed Analysis</h4>
                    ${Object.entries(results.checks).map(([key, check]) => `
                        <div class="ats-issue ${check.passed ? 'success' : 'critical'}">
                            <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 10px;">
                                <strong>${check.category}</strong>
                                <span style="margin-left: auto;">${check.passed ? '✅' : '❌'} ${Math.round(check.score)}%</span>
                            </div>
                            ${check.issues && check.issues.length > 0 ? `
                                <ul style="margin: 10px 0; padding-left: 20px;">
                                    ${check.issues.map(issue => `<li>${issue}</li>`).join('')}
                                </ul>
                            ` : '<div style="color: #155724;">✓ This section looks good!</div>'}
                            ${check.foundSections ? `
                                <div><strong>Found sections:</strong> ${check.foundSections.join(', ')}</div>
                            ` : ''}
                            ${check.missingSections && check.missingSections.length > 0 ? `
                                <div><strong>Missing sections:</strong> ${check.missingSections.join(', ')}</div>
                            ` : ''}
                            ${check.wordCount ? `
                                <div><strong>Word count:</strong> ${check.wordCount} words</div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>

                ${results.keywords && results.keywords.length > 0 ? `
                    <div class="ats-section">
                        <h4 style="color: #667eea; margin-bottom: 15px;">🔑 Keywords Found</h4>
                        <div class="ats-keywords">
                            ${results.keywords.map(keyword => `
                                <span class="ats-keyword found">${keyword}</span>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}

                <div class="ats-section">
                    <h4 style="color: #667eea; margin-bottom: 15px;">💡 Improvement Recommendations</h4>
                    <ul style="padding-left: 20px;">
                        ${results.recommendations.slice(0, 8).map(rec => `<li style="margin-bottom: 8px;">${rec}</li>`).join('')}
                    </ul>
                </div>

                <div style="background: #e8f0fe; border: 1px solid #667eea; border-radius: 8px; padding: 20px; margin-top: 20px;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">🎯 Quick ATS Tips</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div>
                            <strong>✅ DO:</strong>
                            <ul style="margin: 5px 0 0 20px; font-size: 0.9rem;">
                                <li>Use standard section headers</li>
                                <li>Include relevant keywords</li>
                                <li>Use simple formatting</li>
                                <li>Save as PDF or Word doc</li>
                            </ul>
                        </div>
                        <div>
                            <strong>❌ AVOID:</strong>
                            <ul style="margin: 5px 0 0 20px; font-size: 0.9rem;">
                                <li>Images and graphics</li>
                                <li>Complex tables</li>
                                <li>Unusual fonts</li>
                                <li>Multiple columns</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary" onclick="generateATSReport()">📥 Download ATS Report</button>
                </div>
            `;
        }

        function generateATSReport() {
            const reportContent = document.getElementById('atsTestContent').innerText;
            const blob = new Blob([`ATS Compatibility Report\n\nGenerated: ${new Date().toLocaleString()}\n\n${reportContent}`], 
                { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ats_compatibility_report.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
        function removeResume() {
            uploadedResume = null;
            resumeText = '';
            document.getElementById('uploadPrompt').style.display = 'block';
            document.getElementById('uploadedResume').style.display = 'none';
            document.getElementById('resumeUploadArea').classList.remove('resume-uploaded');
            document.getElementById('resumeInfo').style.display = 'none';
            document.getElementById('resumeFile').value = '';
            
            showNotification('Resume removed successfully.', 'info');
        }

        function viewResumePreview() {
            if (!resumeText) {
                showNotification('Resume preview not available. Please re-upload your resume.', 'error');
                return;
            }

            document.getElementById('resumePreviewContent').innerHTML = `<pre style="white-space: pre-wrap; font-family: inherit;">${resumeText}</pre>`;
            document.getElementById('resumeModal').style.display = 'block';
        }

        function closeResumeModal() {
            document.getElementById('resumeModal').style.display = 'none';
        }

        function tailorResumeForJob(jobId) {
            if (!uploadedResume) {
                showNotification('Please upload your resume first to use the tailoring feature.', 'error');
                return;
            }

            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;

            document.getElementById('tailoredResumeModal').style.display = 'block';
            
            // Simulate AI processing
            setTimeout(() => {
                const tailoredContent = generateTailoredResume(job);
                document.getElementById('tailoredResumeContent').innerHTML = tailoredContent;
                document.getElementById('downloadTailoredBtn').style.display = 'inline-block';
            }, 3000);
        }

        function generateTailoredResume(job) {
            return `
                <div style="background: white; padding: 20px; border-radius: 8px; font-family: 'Times New Roman', serif;">
                    <h3 style="color: #333; border-bottom: 2px solid #667eea; padding-bottom: 10px;">Resume Tailored for: ${job.title}</h3>
                    <p style="color: #666; font-style: italic; margin-bottom: 20px;">Optimized for ${job.company}</p>
                    
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">🎯 Key Matches Highlighted:</h4>
                        <ul style="color: #333;">
                            ${job.requirements ? job.requirements.map(req => `<li><strong>${req}</strong> - Emphasized in experience section</li>`).join('') : '<li>Requirements emphasized based on job description</li>'}
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">📝 Tailored Summary:</h4>
                        <p style="background: #f8f9fa; padding: 15px; border-left: 4px solid #667eea; margin: 0;">
                            Experienced professional with expertise in ${job.requirements ? job.requirements.slice(0, 3).join(', ') : 'relevant technologies'} 
                            seeking to contribute to ${job.company}'s ${job.title.toLowerCase()} role. 
                            Proven track record in ${job.type.includes('remote') ? 'remote collaboration and' : ''} 
                            delivering high-quality solutions that drive business impact.
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #667eea;">🚀 Optimization Notes:</h4>
                        <ul style="color: #666; font-size: 0.9rem;">
                            <li>Keywords from job description integrated throughout</li>
                            <li>Experience bullets reordered to emphasize relevant skills</li>
                            <li>Technical skills section updated to match requirements</li>
                            <li>Achievement metrics aligned with ${job.company}'s values</li>
                        </ul>
                    </div>

                    <div style="background: #e8f0fe; padding: 15px; border-radius: 6px; border: 1px solid #667eea;">
                        <p style="margin: 0; color: #333;"><strong>💡 AI Recommendation:</strong> 
                        This tailored resume increases your match score for this position by highlighting your ${job.requirements ? job.requirements[0] : 'key'} experience 
                        and aligning your background with ${job.company}'s needs.</p>
                    </div>
                </div>
            `;
        }

        function downloadTailoredResume() {
            const content = document.getElementById('tailoredResumeContent').innerText;
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'tailored_resume.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Tailored resume downloaded! 📥', 'success');
        }

        function closeTailoredResumeModal() {
            document.getElementById('tailoredResumeModal').style.display = 'none';
        }

        // Drag and drop functionality
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('resumeUploadArea');
            
            uploadArea.addEventListener('dragenter', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const input = document.getElementById('resumeFile');
                    input.files = files;
                    handleFileUpload(input);
                }
            });
        }

        // Future API implementations (placeholders)
        async function fetchIndeedJobs(query, location) {
            showNotification('Indeed API integration coming soon! 🚀', 'info');
            return [];
        }

        async function fetchGitHubJobs(query, location) {
            showNotification('GitHub Jobs API integration coming soon! 💻', 'info');
            return [];
        }

        async function fetchLinkedInJobs(query, location) {
            showNotification('LinkedIn API integration coming soon! 💼', 'info');
            return [];
        }

        // Search functionality
        async function searchJobs() {
            const query = document.getElementById('jobQuery').value;
            const location = document.getElementById('locationQuery').value;
            const jobType = document.getElementById('jobTypeFilter').value;

            showLoading();
            showNotification(`Searching for ${query || 'all'} jobs${location ? ' in ' + location : ''}...`, 'info');

            try {
                await new Promise(resolve => setTimeout(resolve, 1500));

                const api = JOB_APIS[currentSource];
                if (!api.enabled) {
                    throw new Error(`${api.name} is not yet available`);
                }

                let jobs = await api.fetch(query, location);
                
                // Filter jobs based on search criteria
                if (query) {
                    const searchTerm = query.toLowerCase();
                    jobs = jobs.filter(job => 
                        job.title.toLowerCase().includes(searchTerm) ||
                        job.company.toLowerCase().includes(searchTerm) ||
                        job.description.toLowerCase().includes(searchTerm) ||
                        (job.requirements && job.requirements.some(req => 
                            req.toLowerCase().includes(searchTerm)
                        ))
                    );
                }

                if (location) {
                    const locationTerm = location.toLowerCase();
                    jobs = jobs.filter(job => 
                        job.location.toLowerCase().includes(locationTerm)
                    );
                }

                if (jobType) {
                    jobs = jobs.filter(job => job.type === jobType);
                }

                allJobs = jobs;
                renderJobs(jobs);
                
                showNotification(`Found ${jobs.length} jobs matching your criteria!`, 'success');
                
            } catch (error) {
                console.error('Search error:', error);
                showNotification('Error searching jobs: ' + error.message, 'error');
                renderJobs([]);
            }
        }

        function renderJobs(jobs) {
            const container = document.getElementById('jobsContainer');
            
            if (jobs.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 40px 20px; color: #6c757d;">
                        <h3>🔍 No jobs found</h3>
                        <p>Try adjusting your search criteria or check back later for new listings.</p>
                        <p><strong>Tips:</strong> Use broader keywords or try different locations.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = jobs.map(job => `
                <div class="job-card">
                    <div class="job-source">${job.source}${job.isReal ? '<span class="real-job-badge">REAL JOB</span>' : ''}</div>
                    <div class="job-title" style="font-size: 1.3rem; font-weight: bold; color: #333; margin-bottom: 8px;">${job.title}</div>
                    <div class="job-company" style="font-size: 1.1rem; color: #667eea; margin-bottom: 8px;">${job.company}</div>
                    <div class="job-meta" style="color: #6c757d; margin-bottom: 12px;">
                        📍 ${job.location} • 
                        ${job.type.charAt(0).toUpperCase() + job.type.slice(1).replace('-', ' ')} • 
                        Posted ${formatDate(job.posted)}
                    </div>
                    <div class="job-meta" style="color: #6c757d; margin-bottom: 12px;">💰 ${job.salary}</div>
                    <div class="job-description" style="color: #495057; line-height: 1.6; margin-bottom: 15px;">${truncateText(job.description, 200)}</div>
                    <div class="job-actions" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="viewJobDetails('${job.id}')" style="padding: 8px 16px; font-size: 14px;">View Details</button>
                        <button class="btn btn-primary" onclick="tailorResumeForJob('${job.id}')" style="padding: 8px 16px; font-size: 14px;" ${!uploadedResume ? 'title="Upload resume first"' : ''}>
                            ${uploadedResume ? '🎯 Tailor Resume' : '📄 Upload Resume First'}
                        </button>
                        <button class="btn btn-success" onclick="window.open('${job.url}', '_blank')" style="padding: 8px 16px; font-size: 14px;">Apply Now</button>
                    </div>
                </div>
            `).join('');
        }

        function showLoading() {
            document.getElementById('jobsContainer').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>🔍 Searching job boards...</p>
                </div>
            `;
        }

        function viewJobDetails(jobId) {
            const job = allJobs.find(j => j.id === jobId);
            if (!job) return;

            alert(`📋 Job Details

Title: ${job.title}
Company: ${job.company}
Location: ${job.location}
Type: ${job.type.charAt(0).toUpperCase() + job.type.slice(1).replace('-', ' ')}
Salary: ${job.salary}

Description:
${job.description}

Requirements:
${job.requirements ? job.requirements.join(', ') : 'See job posting for details'}

Posted: ${formatDate(job.posted)}
Source: ${job.source}`);
        }

        // Utility functions
        function formatDate(date) {
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) return '1 day ago';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            return `${Math.floor(diffDays / 30)} months ago`;
        }

        function truncateText(text, maxLength) {
            return text.length <= maxLength ? text : text.substring(0, maxLength) + '...';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 4000);
        }

        // API source selector
        function setupAPISelector() {
            const apiOptions = document.querySelectorAll('.api-option');
            apiOptions.forEach(option => {
                option.addEventListener('click', () => {
                    if (option.classList.contains('coming-soon')) {
                        showNotification('This API integration is coming soon! 🚀', 'info');
                        return;
                    }
                    
                    apiOptions.forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    currentSource = option.dataset.source;
                    updateAPIStatus();
                });
            });
        }

        function updateAPIStatus() {
            const statusEl = document.getElementById('apiStatus');
            const api = JOB_APIS[currentSource];
            
            if (api.enabled) {
                statusEl.className = 'api-status online';
                statusEl.innerHTML = `✅ Connected to ${api.name} - Ready to search real jobs!`;
            } else {
                statusEl.className = 'api-status offline';
                statusEl.innerHTML = `🔧 Currently using demo data - Real job APIs coming soon!`;
            }
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const resumeModal = document.getElementById('resumeModal');
            const tailoredModal = document.getElementById('tailoredResumeModal');
            const atsModal = document.getElementById('atsTestModal');
            
            if (event.target === resumeModal) {
                resumeModal.style.display = 'none';
            }
            if (event.target === tailoredModal) {
                tailoredModal.style.display = 'none';
            }
            if (event.target === atsModal) {
                atsModal.style.display = 'none';
            }
        }

        // Initialize the app
        function initializeApp() {
            console.log('📊 Initializing Production Job Search...');
            
            setupAPISelector();
            setupDragAndDrop();
            updateAPIStatus();
            
            // Setup event listeners
            document.getElementById('jobQuery').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchJobs();
            });

            document.getElementById('locationQuery').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchJobs();
            });

            document.getElementById('jobTypeFilter').addEventListener('change', searchJobs);

            // Initial load
            searchJobs();
            
            console.log('✅ Production app ready!');
            showNotification('🚀 AI Job Search Assistant ready! Upload your resume to get started.', 'success');
        }

        // Start the app
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>